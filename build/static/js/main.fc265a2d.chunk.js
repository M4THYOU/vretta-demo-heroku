(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(54),o=a.n(s),c=(a(62),a(6)),l=a(7),i=a(8),u=a(9),m=(a(63),a(12)),d=a(17),h=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(d.b,{to:"/app"},"Enter"))}}]),a}(n.Component),p=a(104),g=a(105),f=a(14),v=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(l.a)(a,[{key:"redirectHandler",value:function(e){var t=this,a=new f.a("wss://inrtpyg747.execute-api.us-east-2.amazonaws.com/dev",{timeout:5e3,maxAttempts:10,onopen:function(e){console.log("Connected!",e),a.json({action:"getToken"})},onmessage:function(a){console.log("Received:",a);var n=JSON.parse(a.data);if("getJWT"===n.eventType){var r=n.Attributes.token;localStorage.setItem("uid",r),localStorage.setItem("isCoach",e),e?t.props.history.push("/app/coach/"):t.props.history.push("/app/player/")}},onreconnect:function(e){return console.log("Reconnecting...",e)},onmaximum:function(e){return console.log("Stop Attempting!",e)},onclose:function(e){return console.log("Closed!",e)},onerror:function(e){return console.log("Error:",e)}})}},{key:"render",value:function(){var e=this,t=localStorage.getItem("isCoach");return"false"===t?this.props.history.push("/app/player"):"true"===t&&this.props.history.push("/app/coach"),localStorage.getItem("uid"),r.a.createElement("div",null,r.a.createElement("h2",null,"App"),r.a.createElement(p.a,null,r.a.createElement(g.a,{outline:!0,color:"primary",onClick:function(){e.redirectHandler(!0)}},"Coach"),r.a.createElement(g.a,{outline:!0,color:"primary",onClick:function(){e.redirectHandler(!1)}},"Player")))}}]),a}(n.Component),y=a(106),E=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;Object(c.a)(this,a),n=t.call(this,e);var r="/app/";return r+=e.isCoach?"coach/":"player/",r+=e.obj._id,n.state={game:e.obj,link:r},n}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,null,r.a.createElement(d.b,{to:{pathname:this.state.link,state:{game:this.state.game}}},r.a.createElement(g.a,null,this.props.obj._id," | ",this.props.obj.date)))}}]),a}(n.Component);function b(e){var t=Object.keys(e).map((function(t){return{_id:t,date:e[t].date,coachId:e[t].coachId}}));return t.sort((function(e,t){var a=new Date(e.date),n=new Date(t.date);return a>n?-1:a<n?1:0})),t}function k(e,t){return r.a.createElement(E,{obj:e,key:e._id,isCoach:t})}var C=a(107),j=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={games:{},games_sorted:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=new f.a("wss://inrtpyg747.execute-api.us-east-2.amazonaws.com/dev",{timeout:5e3,maxAttempts:10,onopen:function(e){console.log("Connected!",e),t.json({action:"getGames"})},onmessage:function(t){console.log("Received:",t);var a=JSON.parse(t.data);if("gamesData"===a.eventType){console.log(a.Items);var n={};a.Items.forEach((function(e){n[e.gameId]={date:e.date,coachId:e.coachId}}));var r=b(n);e.setState({games:n,games_sorted:r})}},onreconnect:function(e){return console.log("Reconnecting...",e)},onmaximum:function(e){return console.log("Stop Attempting!",e)},onclose:function(e){return console.log("Closed!",e)},onerror:function(e){return console.log("Error:",e)}})}},{key:"render",value:function(){var e=this.state.games_sorted;return r.a.createElement("div",null,r.a.createElement("h2",null,"Player"),r.a.createElement("h3",null,"Games"),r.a.createElement(C.a,null,e.map((function(e){return k(e,!1)}))))}}]),a}(n.Component),I=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={games:{},games_sorted:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.state.socket=new f.a("wss://inrtpyg747.execute-api.us-east-2.amazonaws.com/dev",{timeout:5e3,maxAttempts:10,onopen:function(t){console.log("Connected!",t),e.state.socket.json({action:"getGames"})},onmessage:function(t){console.log("Received:",t);var a=JSON.parse(t.data),n=a.eventType;if("gamesData"===n){console.log(a.Items);var r={};a.Items.forEach((function(e){r[e.gameId]={date:e.date,coachId:e.coachId}}));var s=b(r);e.setState({games:r,games_sorted:s})}else if("createGame"===n){var o=a.gameId;e.props.history.push({pathname:"/app/coach/"+o})}},onreconnect:function(e){return console.log("Reconnecting...",e)},onmaximum:function(e){return console.log("Stop Attempting!",e)},onclose:function(e){return console.log("Closed!",e)},onerror:function(e){return console.log("Error:",e)}})}},{key:"newGame",value:function(){var e={coachId:localStorage.getItem("uid")};this.state.socket.json({action:"createGame",data:e})}},{key:"render",value:function(){var e=this,t=this.state.games_sorted;return r.a.createElement("div",null,r.a.createElement("h2",null,"Coach"),r.a.createElement(g.a,{color:"primary",onClick:function(){e.newGame()}},"Create Game"),r.a.createElement("h3",null,"Games"),r.a.createElement(C.a,null,t.map((function(e){return k(e,!0)}))))}}]),a}(n.Component),O=Object(m.f)(I),w=a(15),S=a(108),A=a(109),x=a(110),M=a(111),B=a(112),N=a(113),T=a(114),U=a(16),R=a.n(U),P=a(37),D=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).audioRef=r.a.createRef(),n.state={chatTitle:"Current Chat",players:[],currentChat:[],broadcasts:[],currentMessage:"",selectedPlayer:null,showBroadcasts:!1,messages:{},game:null,socket:null,isActive:{},hasUnread:{}},n}return Object(l.a)(a,[{key:"exitHandler",value:function(){window.location.href="/app/coach"}},{key:"componentDidMount",value:function(){var e=this;this.state.socket=new f.a("wss://inrtpyg747.execute-api.us-east-2.amazonaws.com/dev",{timeout:5e3,maxAttempts:10,onopen:function(t){console.log("Connected!");var a={gameId:e.props.match.params.gameId};e.state.socket.json({action:"coachConnect",data:a})},onmessage:function(t){console.log("Received:",t);var a=JSON.parse(t.data),n=a.eventType;if("gameData"===n){var r=a.Attributes;console.log(r),e.setState({players:r.players,broadcasts:r.broadcasts,messages:r.messages,game:r,isActive:r.isActive,hasUnread:r.hasUnread})}else if("playerUpdate"===n){var s=a.playerList,o=a.currPlayer,c=a.isActive;console.log(c),console.log(o),e.setState({players:s,isActive:R()(e.state.isActive,Object(w.a)({},o,{$set:c}))})}else if("message"===n){console.log(a);var l=a.Attributes.message,i=a.Attributes.playerId;if(e.audioRef.current.play().catch((function(e){console.log(e)})),i===e.state.selectedPlayer){var u=e.state.currentChat.slice();u.push([l,!1]),e.setState({messages:R()(e.state.messages,Object(w.a)({},i,{$set:u})),currentChat:u,hasUnread:R()(e.state.hasUnread,Object(w.a)({},i,{$set:!1}))}),e.updateUnread(i,!1)}else{var m=e.state.messages[i];"undefined"===typeof m&&(m=[]),m.push([l,!1]),e.setState({messages:R()(e.state.messages,Object(w.a)({},i,{$set:m})),hasUnread:R()(e.state.hasUnread,Object(w.a)({},i,{$set:!0}))})}}else if("playerChangeConnection"===n){console.log(a);var d=a.Attributes.isActive,h=a.Attributes.playerId;e.setState({isActive:R()(e.state.isActive,Object(w.a)({},h,{$set:d}))})}},onreconnect:function(e){return console.log("Reconnecting...",e)},onmaximum:function(e){return console.log("Stop Attempting!",e)},onclose:function(e){return console.log("Closed!",e)},onerror:function(e){return console.log("Error:",e)}})}},{key:"updateUnread",value:function(e,t){var a={gameId:this.state.game.gameId,unread:t,playerId:e};this.state.socket.json({action:"updateUnread",data:a})}},{key:"playerOnClick",value:function(e){var t=this.state.messages[e];this.state.hasUnread[e]&&this.updateUnread(e,!1),"undefined"===typeof t?this.setState({currentChat:[],selectedPlayer:e,showBroadcasts:!1,chatTitle:"Current Chat",hasUnread:R()(this.state.hasUnread,Object(w.a)({},e,{$set:!1}))}):this.setState({currentChat:t,selectedPlayer:e,showBroadcasts:!1,chatTitle:"Current Chat",hasUnread:R()(this.state.hasUnread,Object(w.a)({},e,{$set:!1}))})}},{key:"sendMessage",value:function(e){e.preventDefault();var t=this.state.selectedPlayer,a=this.state.showBroadcasts;if(t||a)if(""!==this.state.currentMessage){var n=localStorage.getItem("uid"),r=this.state.currentMessage,s=this.state.game.gameId,o=this.state.currentChat.slice();if(a){var c=[r,!0,!0];o.push(c);var l=this.state.broadcasts.slice();l.push(c),this.setState({broadcasts:l})}else o.push([r,!0]);if(this.setState({messages:R()(this.state.messages,Object(w.a)({},t,{$set:o})),currentChat:o,currentMessage:""}),a){if(this.state.socket){var i={message:r,gameId:s};this.state.socket.json({action:"broadcast",data:i})}}else if(this.state.socket){var u={coachId:n,message:r,playerId:t,gameId:s};this.state.socket.json({action:"messageFromCoach",data:u})}}else console.log("empty message, returning");else console.log("returning...")}},{key:"broadcastInitHandler",value:function(){this.setState({currentChat:this.state.broadcasts,selectedPlayer:"broadcast",showBroadcasts:!0,chatTitle:"Broadcast"})}},{key:"updateMessage",value:function(e){this.setState({currentMessage:e.target.value})}},{key:"renderMarginCol",value:function(e){if(e[1])return r.a.createElement(S.a,null)}},{key:"renderBroadcastBar",value:function(e){if(e[2])return r.a.createElement(y.a,{className:"my-broadcast-bar"})}},{key:"renderMsg",value:function(e,t){var a="secondary";return e[1]&&(a="info"),r.a.createElement(A.a,{key:t},this.renderMarginCol(e),r.a.createElement(S.a,{sm:"auto",className:"no-margin-message"},r.a.createElement(y.a,{color:a,key:t},e[0])),this.renderBroadcastBar(e))}},{key:"renderActiveIndicator",value:function(e){return this.state.isActive[e]?r.a.createElement(g.a,{color:"success",className:"active-button",outline:!0},"Active"):r.a.createElement(g.a,{color:"danger",className:"active-button",outline:!0},"Inactive")}},{key:"renderUnread",value:function(e){if(this.state.hasUnread[e])return r.a.createElement(S.a,null,r.a.createElement("h1",{className:"message-indicator"},"\u2022"))}},{key:"renderPlayer",value:function(e){var t=this,a="player-row";if("placeholder"!==e)return this.state.selectedPlayer===e&&(a+=" selected"),r.a.createElement(A.a,{onClick:function(){return t.playerOnClick(e)},key:e,className:a},r.a.createElement(S.a,{xs:"6",key:e},e.slice(-10)),r.a.createElement(S.a,{xs:"3"},this.renderActiveIndicator(e)),this.renderUnread(e))}},{key:"renderPlayers",value:function(){var e=this,t=[];return null!==this.state&&"undefined"!==typeof this.state&&(t=this.state.players),void 0===t||t.length<2?r.a.createElement("p",null,"Looking for players..."):r.a.createElement(x.a,null,t.map((function(t){return e.renderPlayer(t)})))}},{key:"renderBroadcastButton",value:function(){var e=this;return"broadcast"===this.state.selectedPlayer?r.a.createElement(g.a,{color:"info",onClick:function(){return e.broadcastInitHandler()}},"Broadcast"):r.a.createElement(g.a,{color:"info",onClick:function(){return e.broadcastInitHandler()},outline:!0},"Broadcast")}},{key:"render",value:function(){var e=this,t=this.state.currentChat;"undefined"===typeof t&&(t=[]);var a=this.state.selectedPlayer;return"broadcast"===a?a="":a&&(a=a.slice(-10)),r.a.createElement(x.a,{className:"outer-container"},r.a.createElement("audio",{id:"message-sound",ref:this.audioRef,src:P}),r.a.createElement(g.a,{className:"float-sm-left",color:"danger",onClick:function(){e.exitHandler()}},"EXIT"),r.a.createElement(A.a,{className:"outer-row"},r.a.createElement(S.a,{xs:"6"},r.a.createElement("h2",null,"Broadcast"),this.renderBroadcastButton(),r.a.createElement("h2",null,"Players"),this.renderPlayers()),r.a.createElement(S.a,{xs:"6",className:"chat-view"},r.a.createElement("h2",null,this.state.chatTitle),r.a.createElement("h6",null,a),t.map((function(t,a){return e.renderMsg(t,a)}))),r.a.createElement(S.a,{xs:{size:6,offset:6}},r.a.createElement(M.a,null,r.a.createElement(B.a,{for:"message",hidden:!0},"Type here..."),r.a.createElement(N.a,{type:"text",name:"message",id:"message",placeholder:"Type here...",value:this.state.currentMessage,onChange:function(t){return e.updateMessage(t)}}),r.a.createElement(T.a,{addonType:"append"},r.a.createElement(g.a,{onClick:function(t){return e.sendMessage(t)}},"Send"))))))}}]),a}(n.Component),G=(a(69),a(37)),H=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e)).audioRef=r.a.createRef();e.location.state.game;return n.state={currentChat:[],currentMessage:"",gameId:null,coachId:null,socket:null},n}return Object(l.a)(a,[{key:"exitHandler",value:function(){window.location.href="/app/player"}},{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("uid");this.state.socket=new f.a("wss://inrtpyg747.execute-api.us-east-2.amazonaws.com/dev",{timeout:5e3,maxAttempts:10,onopen:function(a){console.log("Connected!",a);var n=e.props.match.params.gameId,r={uid:t,gameId:n};e.state.socket.json({action:"playerConnect",data:r})},onmessage:function(t){console.log("Received:",t);var a=JSON.parse(t.data),n=a.eventType;if("getGame"===n){var r=a.Attributes.gameId,s=a.Attributes.coachId,o=a.Attributes.chat;e.setState({currentChat:o,gameId:r,coachId:s})}else if("message"===n){var c=a.Attributes.message;e.audioRef.current.play().catch((function(e){console.log(e)}));var l=e.state.currentChat.slice();l.push([c,!0]),e.setState({currentChat:l})}else if("broadcast"===n){var i=a.Attributes.message;e.audioRef.current.play().catch((function(e){console.log(e)}));var u=e.state.currentChat.slice();u.push([i,!0,!0]),e.setState({currentChat:u})}},onreconnect:function(e){return console.log("Reconnecting...",e)},onmaximum:function(e){return console.log("Stop Attempting!",e)},onclose:function(e){return console.log("Closed!",e)},onerror:function(e){return console.log("Error:",e)}})}},{key:"sendMessage",value:function(e){if(e.preventDefault(),""!==this.state.currentMessage){var t=localStorage.getItem("uid"),a=this.state.currentMessage,n=this.state.gameId,r=this.state.currentChat.slice();if(r.push([a,!1]),this.setState({currentChat:r,currentMessage:""}),console.log(a),this.state.socket){var s={uid:t,message:a,gameId:n};this.state.socket.json({action:"messageFromPlayer",data:s})}}else console.log("empty message, returning")}},{key:"updateMessage",value:function(e){this.setState({currentMessage:e.target.value})}},{key:"renderMarginCol",value:function(e){if(!e[1])return r.a.createElement(S.a,null)}},{key:"renderBroadcastBar",value:function(e){if(e[2])return r.a.createElement(y.a,{className:"not-my-broadcast-bar"})}},{key:"renderMsg",value:function(e,t){var a="secondary";return e[1]||(a="info"),r.a.createElement(A.a,{key:t},this.renderMarginCol(e),this.renderBroadcastBar(e),r.a.createElement(S.a,{sm:"auto",className:"no-margin-message"},r.a.createElement(y.a,{color:a,key:t},e[0])))}},{key:"render",value:function(){var e=this,t=this.state.currentChat;return r.a.createElement(x.a,{className:"outer-container"},r.a.createElement("audio",{id:"message-sound",ref:this.audioRef,src:G}),r.a.createElement(g.a,{className:"float-sm-left",color:"danger",onClick:function(){e.exitHandler()}},"EXIT"),r.a.createElement(A.a,{className:"outer-row"},r.a.createElement(S.a,{sm:{size:6,offset:3},className:"chat-view"},r.a.createElement("h2",null,"Current Chat"),t.map((function(t,a){return e.renderMsg(t,a)}))),r.a.createElement(S.a,{sm:{size:6,offset:3}},r.a.createElement(M.a,null,r.a.createElement(B.a,{for:"message",hidden:!0},"Type here..."),r.a.createElement(N.a,{type:"text",name:"message",id:"message",placeholder:"Type here...",value:this.state.currentMessage,onChange:function(t){return e.updateMessage(t)}}),r.a.createElement(T.a,{addonType:"append"},r.a.createElement(g.a,{onClick:function(t){return e.sendMessage(t)}},"Send"))))))}}]),a}(n.Component),$=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/",component:h}),r.a.createElement(m.a,{exact:!0,path:"/app",component:v}),r.a.createElement(m.a,{exact:!0,path:"/app/coach",component:O}),r.a.createElement(m.a,{path:"/app/coach/:gameId",component:D}),r.a.createElement(m.a,{exact:!0,path:"/app/player",component:j}),r.a.createElement(m.a,{path:"/app/player/:gameId",component:H})))}}]),a}(n.Component),_=Object(m.f)($);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(101);o.a.render(r.a.createElement(d.a,null,r.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},37:function(e,t,a){e.exports=a.p+"static/media/when.6caba2fa.mp3"},57:function(e,t,a){e.exports=a(102)},62:function(e,t,a){},63:function(e,t,a){},98:function(e,t){}},[[57,1,2]]]);
//# sourceMappingURL=main.fc265a2d.chunk.js.map